# 智能救援机器人视觉系统
智能救援视觉代码

这是一个基于OpenCV的视觉代码，使用泰山派，用于智能救援，检测和识别红、黄、蓝、黑四种颜色的小球。
目前的策略是机器人看到哪个小球就夹取哪个小球，不分优先级（因为考虑我们是第一次接触这种比赛，所以打算一切按简单的来，不过要是后续有时间，有可能会改为按优先级夹取小球）

比赛分成两种：积分赛+对抗赛，无论是哪种比赛，都是通过抽签决定队伍颜色，然后要防止机器人夹取对方队伍颜色小球，机器人只能夹取自己队伍的小球，黄色小球和黑色小球。其中机器人首次必须自主夹取己方队伍颜色小球，每次夹取黄色小球时只能夹取一个小球，也就是说当机器人夹取黄色小球后要停止夹球然后立马将黄色小球运到安全区，安全区外边有紫色围栏
积分赛：抢时间
对抗赛：拉分差（可阻挡对方夹高分小球的路径）


## 功能特性

- **多颜色检测**：支持红、黄、蓝、黑四种颜色的小球检测
- **紫色围栏识别**：专门识别紫色围栏，用于确定有效操作区域
- **目标跟踪**：实时跟踪检测到的小球位置
- **安全区检测**：自动识别和检测安全区域，避免误抓取己方区域内的小球
- **黄色球限制规则**：严格执行黄色球（危险球）的特殊处理规则
- **围栏内小球过滤**：只考虑紫色围栏外的小球作为有效目标
- **可视化界面**：实时显示检测结果和最佳目标标记
- **配置灵活**：支持通过JSON配置文件调整颜色阈值和游戏策略
- **阈值调试工具**：提供各颜色专用的HSV阈值调试工具
- **错误处理**：增强的错误处理机制，确保系统稳定运行

## 项目结构

```
rescue_vision_2.0/
├── .gitignore
├── README.md
├── config/
│   ├── config.json
│   ├── hsv_thresholds_black.json
│   └── hsv_thresholds_red.json
├── src/
│   ├── UART.py
│   ├── main.py
│   └── vision.py
└── tests/
    ├── 紫色阈值.py
    ├── 红色阈值.py
    ├── 蓝色阈值.py
    ├── 黄色阈值.py
    └── 黑色阈值.py
```

## 配置说明
1. 运行阈值文件，然后会在config目录生成对应颜色的阈值配置文件
2. 其他配置都在config文件里面，包含：
队伍颜色
摄像头的索引，图像分辨率，帧率用默认值
串口设备，波特率，读取超时时间用默认值1秒 


## 主要模块功能
1. 串口通信模块（UART.py)
串口初始化与关闭
数据包构建与CRC校验
命令执行与状态读取
2. 视觉处理模块 (vision.py)
视频流捕获与处理
目标球体检测
安全区域检测
位置判断与状态检测
3. 主程序 (main.py)
实现状态机控制逻辑：
状态0：寻找球体
状态1：接近小球
状态2：抓取小球
状态3：寻找安全区，即目标区域
状态4：放置小球

## 注意事项
1. 串口通信模块需要根据实际情况进行修改，如串口名称、波特率等
2. 视觉处理模块需要根据实际情况进行修改，如视频源、颜色阈值等
3. 运行前确保所有硬件连接正确





